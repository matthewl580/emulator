{
  "initCode": "// Platformer Init\nwindow._state = {\n  player: {\n    x: 10,\n    y: 32,\n    vx: 0,\n    vy: 0,\n    onGround: false\n  },\n  platforms: [\n    { x: 0, y: 60, width: 64 },  // ground\n    { x: 20, y: 45, width: 20 },  // platform 1\n    { x: 10, y: 30, width: 15 },  // platform 2\n    { x: 40, y: 20, width: 20 }   // platform 3\n  ],\n  coins: Array(5).fill().map(() => ({\n    x: Math.floor(Math.random() * 64),\n    y: Math.floor(Math.random() * 40) + 10,\n    collected: false\n  })),\n  score: 0,\n  gameOver: false\n};\n\n// Setup audio\ntry {\n  window._synth = new Tone.Synth().toDestination();\n  window._effects = {\n    jump: () => window._synth.triggerAttackRelease('G4', '32n'),\n    coin: () => window._synth.triggerAttackRelease('C6', '16n')\n  };\n} catch (e) { console.warn('Tone unavailable', e); }",
  "updateCode": "// Platformer Update\n(function(){\n  const canvas = document.getElementById('game-canvas');\n  const ctx = window._ctx || canvas.getContext('2d');\n  const state = window._state;\n  if (!state || state.gameOver) return;\n\n  // Input handling\n  const keys = {};\n  document.onkeydown = (e) => { keys[e.key] = true; };\n  document.onkeyup = (e) => { keys[e.key] = false; };\n\n  // Physics constants\n  const GRAVITY = 0.5;\n  const JUMP_FORCE = -8;\n  const MOVE_SPEED = 0.5;\n  const FRICTION = 0.8;\n\n  // Apply player movement\n  if (keys['ArrowLeft']) state.player.vx -= MOVE_SPEED;\n  if (keys['ArrowRight']) state.player.vx += MOVE_SPEED;\n  if (keys['ArrowUp'] && state.player.onGround) {\n    state.player.vy = JUMP_FORCE;\n    state.player.onGround = false;\n    if (window._effects) window._effects.jump();\n  }\n\n  // Apply physics\n  state.player.vy += GRAVITY;\n  state.player.vx *= FRICTION;\n  \n  // Update position\n  state.player.x += state.player.vx;\n  state.player.y += state.player.vy;\n\n  // Screen bounds\n  state.player.x = Math.max(0, Math.min(63, state.player.x));\n  \n  // Platform collision\n  state.player.onGround = false;\n  state.platforms.forEach(platform => {\n    if (state.player.x >= platform.x && \n        state.player.x <= platform.x + platform.width &&\n        state.player.y >= platform.y - 2 && \n        state.player.y <= platform.y + 2) {\n      if (state.player.vy > 0) {\n        state.player.y = platform.y;\n        state.player.vy = 0;\n        state.player.onGround = true;\n      }\n    }\n  });\n\n  // Coin collection\n  state.coins.forEach(coin => {\n    if (!coin.collected && \n        Math.abs(coin.x - state.player.x) < 2 && \n        Math.abs(coin.y - state.player.y) < 2) {\n      coin.collected = true;\n      state.score += 10;\n      if (window._effects) window._effects.coin();\n    }\n  });\n\n  // Game over check\n  if (state.player.y > 64) {\n    state.gameOver = true;\n  }\n\n  // Clear screen\n  ctx.fillStyle = '#4444aa';\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n  const scale = canvas.width / 64;\n\n  // Draw platforms\n  ctx.fillStyle = '#aa7744';\n  state.platforms.forEach(platform => {\n    ctx.fillRect(platform.x * scale, \n                 platform.y * scale, \n                 platform.width * scale, \n                 scale);\n  });\n\n  // Draw coins\n  ctx.fillStyle = '#ffff00';\n  state.coins.forEach(coin => {\n    if (!coin.collected) {\n      ctx.beginPath();\n      ctx.arc(coin.x * scale, \n              coin.y * scale, \n              scale/2, 0, Math.PI * 2);\n      ctx.fill();\n    }\n  });\n\n  // Draw player\n  ctx.fillStyle = '#44ff44';\n  ctx.fillRect(state.player.x * scale - scale/2, \n               state.player.y * scale - scale, \n               scale, scale * 2);\n\n  // Draw score\n  ctx.fillStyle = '#ffffff';\n  ctx.font = '12px monospace';\n  ctx.fillText(`Score: ${state.score}`, 10, 20);\n\n  // Game over\n  if (state.gameOver) {\n    ctx.fillStyle = '#ffffff';\n    ctx.font = '24px monospace';\n    ctx.fillText('Game Over!', canvas.width/4, canvas.height/2);\n  }\n\n  // Victory check\n  if (state.coins.every(coin => coin.collected)) {\n    ctx.fillStyle = '#ffffff';\n    ctx.font = '24px monospace';\n    ctx.fillText('Victory!', canvas.width/4, canvas.height/2);\n    state.gameOver = true;\n  }\n})();",
  "displayMode": "1",
  "timestamp": "2025-11-04T00:00:00.000Z"
}